#include <gkg-processing-coordinates/SmsVb15OrientationSet.h>
#include <gkg-core-exception/Exception.h>


static float _orientation006[ 6 ][ 3 ] =
{

  {  0.707, 0.0,    0.707 },
  { -0.707, 0.0,    0.707 },
  {  0.0,   0.707,  0.707 },
  {  0.0,   0.707, -0.707 },
  {  0.707, 0.707,  0.0   },
  { -0.707, 0.707,  0.0   }

};


static float _orientation010[ 10 ][ 3 ] =
{

  { 0,         0.794654,  0.607062 },
  { 0,         0.187592,  0.982247 },
  { -0.57735,  0.794655,  0.187592 },
  { -0.934172, 0.187592,  0.303531 },
  { -0.356822, 0.794655, -0.491124 },
  { -0.57735,  0.187592, -0.794655 },
  { 0.356822,  0.794655, -0.491124 },
  { 0.57735,   0.187592, -0.794655 },
  { 0.57735,   0.794655,  0.187592 },
  { 0.934172,  0.187592,  0.303531 }

};


static float _orientation012[ 12 ][ 3 ] =
{

  { 0.862837,   0.35743,  -0.35743  },
  { 0.862837,  -0.35743,  -0.35743  },
  { -0.862837, -0.35743,   0.35743  },
  { -0.862837,  0.35743,   0.35743  },
  { -0.35743,   0.35743,   0.862837 },
  { -0.35743,   0.862837,  0.35743  },
  { 0.35743,    0.862837, -0.35743  },
  { 0.35743,    0.35743,  -0.862837 },
  { 0.35743,   -0.35743,  -0.862837 },
  { 0.35743,   -0.862837, -0.35743  },
  { 0.35743,   -0.862837,  0.35743  },
  { 0.35743,   -0.35743,   0.862837 }

};


static float _orientation020[ 20 ][ 3 ] =
{

  { 1,         0,         0        },
  { 0,         1,         0        },
  { -0.031984, 0.799591,  0.599693 },
  { 0.856706,  0.493831, -0.148949 },
  { 0.834429,  0.309159,  0.456234 },
  { 0.834429, -0.309159,  0.456234 },
  { 0.856706, -0.493831, -0.148949 },
  { 0.822228,  0,        -0.569158 },
  { 0.550834,  0.425872, -0.717784 },
  { 0.468173,  0.834308, -0.291108 },
  { 0.515933,  0.808894,  0.281963 },
  { 0.39189,   0.515855,  0.761785 },
  { 0.478151,  0,         0.878278 },
  { 0.39189,  -0.515855,  0.761785 },
  { 0.515933, -0.808894,  0.281963 },
  { 0.468173, -0.834308, -0.291108 },
  { 0.550834, -0.425872, -0.717784 },
  { 0.111012, -0.264029, -0.958105 },
  { 0.111012,  0.264029, -0.958105 },
  { 0.031984,  0.799591, -0.599693 }

};


static float _orientation030[ 30 ][ 3 ] =
{

  { -0.203863,   0.514819,  0.832707  },
  {  0.198268,   0.515424,  0.833683  },
  { -0.401613,   0.1717,    0.89957   },
  { -0.404233,   0.727507,  0.554373  },
  { -0.202912,   0.939966,  0.274392  },
  { -0.854953,   0.514811,  0.063446  },
  { -0.731617,   0.515422,  0.44618   },
  { -0.406788,   0.171902,  0.897203  },
  { -0.731442,   0.171701,  0.659933  },
  { -0.652153,   0.727506, -0.213146  },
  { -0.323667,   0.939963, -0.10821   },
  { -0.324533,   0.514818, -0.793499  },
  { -0.650425,   0.515423, -0.557931  },
  { -0.978995,   0.171903, -0.109627  },
  { -0.853664,   0.1717,   -0.491708  },
  {  0.00118929, 0.727503, -0.686103  },
  {  0.00288899, 0.939957, -0.34128   },
  {  0.654381,   0.514815, -0.553851  },
  {  0.329642,   0.515419, -0.790999  },
  {  0.198264,  -0.171899,  0.964957  },
  {  0.203859,   0.171698, -0.963826  },
  {  0.652889,   0.727506, -0.210881  },
  {  0.325451,   0.939963, -0.102716  },
  {  0.200891,   0.938861,  0.279613  },
  {  0.404233,   0.727507,  0.554373  },
  {  0.730909,   0.171747,  0.660511  },
  {  0.728967,   0.514811,  0.451195  },
  {  0.854151,   0.515418,  0.0690721 },
  {  0.856472,   0.1719,   -0.48673   },
  {  0.979649,   0.1717,   -0.103953  }

};


static float _orientation064[ 64 ][ 3 ] =
{

  {  1,         0,         0        },
  {  0,         1,         0        },
  { -0.026007,  0.64917,   0.760199 },
  {  0.591136, -0.766176,  0.252058 },
  { -0.236071, -0.524158,  0.818247 },
  { -0.893021, -0.259006,  0.368008 },
  {  0.796184,  0.12903,   0.591137 },
  {  0.233964,  0.929855,  0.283956 },
  {  0.935686,  0.139953,  0.323891 },
  {  0.505827, -0.84471,  -0.17494  },
  {  0.34622,  -0.847539, -0.402256 },
  {  0.456968, -0.630956, -0.626956 },
  { -0.486997, -0.388997,  0.781995 },
  { -0.617845,  0.672831,  0.406898 },
  { -0.576984, -0.104997, -0.809978 },
  { -0.826695, -0.520808,  0.212921 },
  {  0.893712, -0.039987, -0.446856 },
  {  0.290101, -0.541189, -0.789276 },
  {  0.115951, -0.962591, -0.244896 },
  { -0.800182,  0.403092, -0.444101 },
  {  0.513981,  0.83997,   0.173994 },
  { -0.788548,  0.152912, -0.595659 },
  {  0.94928,  -0.233069,  0.211062 },
  {  0.232964,  0.78288,   0.576911 },
  { -0.020999, -0.18799,  -0.981946 },
  {  0.216932, -0.955701,  0.198938 },
  {  0.774003, -0.604002,  0.190001 },
  { -0.160928,  0.35584,   0.920587 },
  { -0.147035,  0.731173, -0.666158 },
  {  0.888141,  0.417066,  0.193031 },
  { -0.561971,  0.231988, -0.793959 },
  { -0.380809,  0.142928,  0.913541 },
  { -0.306,    -0.199,    -0.931001 },
  { -0.332086, -0.130034,  0.934243 },
  { -0.963226, -0.265062,  0.04401  },
  { -0.959502,  0.205107,  0.193101 },
  {  0.452965, -0.888932,  0.067995 },
  { -0.773133,  0.628108,  0.088015 },
  {  0.709082,  0.408047,  0.575066 },
  { -0.692769,  0.023992,  0.72076  },
  {  0.681659,  0.528735, -0.505747 },
  { -0.141995, -0.724976,  0.673978 },
  { -0.740168,  0.388088,  0.549125 },
  { -0.103006,  0.822044,  0.56003  },
  {  0.584037, -0.596038,  0.551035 },
  { -0.088008, -0.335031,  0.938088 },
  { -0.552263, -0.792377,  0.259123 },
  {  0.838158, -0.458086, -0.296056 },
  {  0.362995, -0.560993,  0.74399  },
  { -0.184062,  0.392133, -0.901306 },
  { -0.720938, -0.692941,  0.008999 },
  {  0.433101,  0.682159, -0.589137 },
  {  0.502114,  0.690157,  0.521119 },
  { -0.170944, -0.508833, -0.843722 },
  {  0.462968,  0.422971,  0.778946 },
  {  0.38503,  -0.809064,  0.444035 },
  { -0.713102, -0.247035,  0.656094 },
  {  0.259923,  0.884737, -0.386885 },
  {  0.001,     0.077002, -0.99703  },
  {  0.037002, -0.902057,  0.430027 },
  {  0.57032,  -0.30317,  -0.763428 },
  { -0.282105,  0.145054, -0.948354 },
  {  0.721098,  0.608082,  0.332045 },
  {  0.266985,  0.959945, -0.084995 }

};


static float _orientation256[ 256 ][ 3 ] =
{

  {  0.05901,  -0.013002, 0.998173  },
  {  0.070008,  0.157018, 0.985111  },
  { -0.078038,  0.083041, 0.993486  },
  { -0.092987, -0.086988, 0.99186   },
  {  0.046987, -0.178952, 0.982735  },
  {  0.199944, -0.10897,  0.973729  },
  {  0.211021,  0.052005, 0.976097  },
  {  0.210999,  0.212999, 0.953997  },
  { -0.050982,  0.250913, 0.966666  },
  { -0.208056,  0.18605,  0.960259  },
  { -0.355044,  0.120015, 0.927114  },
  { -0.22505,   0.016004, 0.974216  },
  { -0.239998, -0.156999, 0.957994  },
  { -0.107055, -0.253129, 0.961491  },
  {  0.031988, -0.337873, 0.940648  },
  {  0.191053, -0.268075, 0.944264  },
  {  0.333011, -0.202007, 0.92103   },
  {  0.350043, -0.034004, 0.936116  },
  {  0.353962,  0.131986, 0.9259    },
  {  0.321087,  0.303082, 0.897243  },
  {  0.124035,  0.337095, 0.933264  },
  { -0.028007,  0.395092, 0.918214  },
  { -0.189921,  0.343856, 0.919616  },
  { -0.340929,  0.281942, 0.896814  },
  { -0.483028,  0.214012, 0.849048  },
  { -0.492017,  0.052002, 0.869031  },
  { -0.364886, -0.049984, 0.92971   },
  { -0.376988, -0.226993, 0.897972  },
  { -0.251019, -0.327024, 0.911068  },
  { -0.116041, -0.415148, 0.902323  },
  {  0.027007, -0.49013,  0.871231  },
  {  0.176089, -0.413208, 0.893449  },
  {  0.323985, -0.380982, 0.86596   },
  {  0.451026, -0.272016, 0.850049  },
  {  0.477203, -0.106045, 0.872371  },
  {  0.487906,  0.059988, 0.870832  },
  {  0.468001,  0.231001, 0.853003  },
  {  0.426147,  0.394136, 0.814282  },
  {  0.266963,  0.442939, 0.855883  },
  {  0.120952,  0.485807, 0.865657  },
  { -0.024989,  0.534766, 0.844631  },
  { -0.176029,  0.491082, 0.853142  },
  { -0.323126,  0.437171, 0.839328  },
  { -0.463978,  0.371982, 0.803961  },
  { -0.6139,    0.139977, 0.776874  },
  { -0.617975, -0.018999, 0.785968  },
  { -0.493054, -0.117013, 0.862094  },
  { -0.50379,  -0.292878, 0.812661  },
  { -0.383865, -0.394861, 0.834705  },
  { -0.253926, -0.486859, 0.835757  },
  { -0.113952, -0.565762, 0.816657  },
  {  0.037997, -0.62595,  0.778937  },
  {  0.182983, -0.543949, 0.818924  },
  {  0.328974, -0.543956, 0.771938  },
  {  0.446988, -0.437988, 0.779979  },
  {  0.565718, -0.32084,  0.759621  },
  {  0.595011, -0.163003, 0.787015  },
  {  0.611304, -0.002001, 0.791393  },
  {  0.600103,  0.163028, 0.783134  },
  {  0.568061,  0.325035, 0.756081  },
  {  0.512003,  0.482003, 0.711004  },
  {  0.362192,  0.543287, 0.757401  },
  {  0.211049,  0.594139, 0.776181  },
  {  0.058967,  0.640642, 0.765572  },
  { -0.119057,  0.637302, 0.761361  },
  { -0.274102,  0.590219, 0.759282  },
  { -0.421992,  0.52799,  0.736986  },
  { -0.56001,   0.454008, 0.693012  },
  { -0.598017,  0.298008, 0.744021  },
  { -0.730015,  0.044001, 0.682014  },
  { -0.718931, -0.123988, 0.683934  },
  { -0.607904, -0.181971, 0.772878  },
  { -0.643781, -0.311894, 0.698762  },
  { -0.524667, -0.433725, 0.732535  },
  { -0.395115, -0.537156, 0.745217  },
  { -0.255897, -0.624749, 0.737703  },
  { -0.10601,  -0.694064, 0.712066  },
  {  0.051982, -0.740746, 0.669771  },
  {  0.198017, -0.665057, 0.720062  },
  {  0.338997, -0.682994, 0.646994  },
  {  0.455869, -0.583832, 0.671807  },
  {  0.56721,  -0.477177, 0.671249  },
  {  0.6701,   -0.360054, 0.649097  },
  {  0.704211, -0.210063, 0.678203  },
  {  0.723245, -0.057019, 0.688233  },
  {  0.720289,  0.101041, 0.686276  },
  {  0.696042,  0.258015, 0.67004   },
  {  0.650084,  0.411053, 0.639082  },
  {  0.582844,  0.557851, 0.590842  },
  {  0.441061,  0.629087, 0.640089  },
  {  0.292091,  0.685213, 0.667208  },
  {  0.136935,  0.732653, 0.666684  },
  { -0.035006,  0.74413,  0.667117  },
  { -0.207001,  0.724004, 0.658004  },
  { -0.361776,  0.671585, 0.6466    },
  { -0.506971,  0.602966, 0.615965  },
  { -0.641109,  0.517088, 0.567097  },
  { -0.690897,  0.366945, 0.622907  },
  { -0.718746,  0.206927, 0.663766  },
  { -0.8218,    0.110973, 0.558864  },
  { -0.820917, -0.048995, 0.568942  },
  { -0.787722, -0.210926, 0.578796  },
  { -0.733198, -0.353096, 0.581157  },
  { -0.632761, -0.470822, 0.614768  },
  { -0.516033, -0.577036, 0.63304   },
  { -0.386042, -0.669073, 0.635069  },
  { -0.244127, -0.745387, 0.620322  },
  { -0.092982, -0.802848, 0.588888  },
  {  0.061971, -0.837608, 0.542746  },
  {  0.207049, -0.774182, 0.598141  },
  {  0.355042, -0.784093, 0.509061  },
  {  0.480125, -0.691179, 0.54014   },
  {  0.596018, -0.585017, 0.550016  },
  {  0.703421, -0.465279, 0.537322  },
  {  0.781234, -0.304091, 0.545163  },
  {  0.812165, -0.145029, 0.565115  },
  {  0.821641,  0.016993, 0.569751  },
  {  0.808928,  0.175984, 0.56095   },
  {  0.774726,  0.330883, 0.53881   },
  {  0.718831,  0.477888, 0.504881  },
  {  0.64273,   0.615741, 0.455808  },
  {  0.509022,  0.69703,  0.505021  },
  {  0.366176,  0.758364, 0.539259  },
  {  0.213039,  0.808148, 0.5491    },
  {  0.045984,  0.830708, 0.554805  },
  { -0.123006,  0.826039, 0.550026  },
  { -0.288131,  0.793362, 0.536244  },
  { -0.439982,  0.73497,  0.515979  },
  { -0.579687,  0.658644, 0.479741  },
  { -0.705004,  0.567003, 0.426002  },
  { -0.764589,  0.424772, 0.48474   },
  { -0.800709,  0.269902, 0.534806  },
  { -0.892959,  0.161992, 0.41998   },
  { -0.900927,  0.002,    0.433965  },
  { -0.879831, -0.158969, 0.447914  },
  { -0.833019, -0.319007, 0.45201   },
  { -0.747071, -0.470045, 0.470045  },
  { -0.637748, -0.587767, 0.497803  },
  { -0.513898, -0.689863, 0.509899  },
  { -0.377037, -0.775076, 0.50705   },
  { -0.230976, -0.842913, 0.48595   },
  { -0.081983, -0.889811, 0.448905  },
  {  0.074014, -0.912169, 0.403075  },
  {  0.219092, -0.860361, 0.460193  },
  {  0.362034, -0.86108,  0.357033  },
  {  0.490041, -0.778065, 0.393033  },
  {  0.608025, -0.678028, 0.413017  },
  {  0.718996, -0.558997, 0.412998  },
  {  0.810079, -0.40804,  0.421041  },
  {  0.870877, -0.239966, 0.42894   },
  {  0.894955, -0.073996, 0.439978  },
  {  0.896096,  0.088009, 0.435047  },
  {  0.874684,  0.243912, 0.418849  },
  {  0.83186,   0.391934, 0.392934  },
  {  0.768978,  0.530985, 0.35599   },
  {  0.687097,  0.657093, 0.310044  },
  {  0.564702,  0.745606, 0.353813  },
  {  0.43208,   0.812149, 0.392072  },
  {  0.286963,  0.863887, 0.413946  },
  {  0.126973,  0.895812, 0.42591   },
  { -0.039977,  0.903483, 0.426756  },
  { -0.206046,  0.885199, 0.417094  },
  { -0.364892,  0.84175,  0.397882  },
  { -0.51095,   0.775923, 0.369964  },
  { -0.639907,  0.695898, 0.325952  },
  { -0.753755,  0.597806, 0.272911  },
  { -0.818055,  0.471032, 0.330022  },
  { -0.862916,  0.318969, 0.391962  },
  { -0.938282,  0.216065, 0.270081  },
  { -0.956045,  0.055003, 0.288014  },
  { -0.946681, -0.106964, 0.303898  },
  { -0.909812, -0.267945, 0.316935  },
  { -0.839417, -0.429702, 0.332769  },
  { -0.741292, -0.573226, 0.349138  },
  { -0.624959, -0.687955, 0.368976  },
  { -0.493966, -0.784946, 0.373974  },
  { -0.353977, -0.861944, 0.362977  },
  { -0.211958, -0.918819, 0.332934  },
  { -0.066965, -0.953504, 0.293847  },
  {  0.084956, -0.963501, 0.253868  },
  {  0.228069, -0.924279, 0.306092  },
  {  0.33306,  -0.925168, 0.182033  },
  {  0.466929, -0.85387,  0.229965  },
  {  0.595385, -0.760492, 0.259168  },
  {  0.70974,  -0.647763, 0.276899  },
  {  0.814356, -0.50322,  0.289126  },
  {  0.892778, -0.337916, 0.297926  },
  {  0.938954, -0.162992, 0.302985  },
  {  0.954223,  0.004001, 0.29907   },
  {  0.944039,  0.166007, 0.285012  },
  {  0.909805,  0.321931, 0.261944  },
  {  0.852595,  0.469777, 0.228891  },
  {  0.771212,  0.608168, 0.188052  },
  {  0.644272,  0.742313, 0.184078  },
  {  0.512029,  0.830048, 0.221013  },
  {  0.371982,  0.891957, 0.256988  },
  {  0.218003,  0.934015, 0.283004  },
  {  0.147,     0.978002, 0.148     },
  {  0.050005,  0.955101, 0.292031  },
  { -0.120044,  0.950347, 0.287105  },
  { -0.287133,  0.918424, 0.272126  },
  { -0.444757,  0.861529, 0.244866  },
  { -0.582982,  0.786976, 0.201994  },
  { -0.707118,  0.690116, 0.154026  },
  { -0.823874,  0.547916, 0.144978  },
  { -0.895869,  0.373945, 0.239965  },
  { -0.956936,  0.266982, 0.113992  },
  { -0.984969,  0.108997, 0.133996  },
  { -0.987109, -0.053006, 0.151017  },
  { -0.962463, -0.213103, 0.168081  },
  { -0.907966, -0.372986, 0.190993  },
  { -0.822992, -0.528995, 0.206998  },
  { -0.712235, -0.66622,  0.221073  },
  { -0.584746, -0.777662, 0.2309    },
  { -0.44521,  -0.866409, 0.226107  },
  { -0.302832, -0.932484, 0.196891  },
  { -0.15503,  -0.975188, 0.158031  },
  {  0.003001, -0.992396, 0.123049  },
  { -0.105043,  0.994407, 0.011005  },
  {  0.18497,  -0.973842, 0.131979  },
  {  0.279071, -0.960245, 0.007002  },
  {  0.426883, -0.902753, 0.052986  },
  {  0.560256, -0.822376, 0.0990451 },
  {  0.687169, -0.716176, 0.12203   },
  {  0.794057, -0.589042, 0.150011  },
  {  0.887491, -0.430238, 0.165091  },
  {  0.951729, -0.254927, 0.170951  },
  {  0.983436, -0.085038, 0.160071  },
  {  0.985899,  0.079992, 0.146985  },
  {  0.961934,  0.241983, 0.126991  },
  {  0.912643,  0.396845, 0.097962  },
  {  0.837257,  0.543167, 0.063019  },
  {  0.723919,  0.687923, 0.051994  },
  {  0.588089,  0.807122, 0.052008  },
  {  0.450862,  0.888729, 0.082975  },
  {  0.304931,  0.944788, 0.119973  },
  { -0.233066, -0.972275, 0.019005  },
  {  0.073019,  0.997258, 0.012003  },
  { -0.026001,  0.988038, 0.152006  },
  { -0.200088,  0.969424, 0.142062  },
  { -0.365992,  0.922979, 0.118997  },
  { -0.510695,  0.856488, 0.074955  },
  { -0.640958,  0.76695,  0.030998  },
  { -0.764977,  0.64398,  0.01      },
  {  0.857996, -0.512998, 0.026     },
  { -0.901024,  0.423011, 0.096003  },
  {  0.938499, -0.343182, 0.03802   },
  {  0.983769, -0.177958, 0.022995  },
  {  0.999898, -0.012999, 0.005999  },
  { -0.988633, -0.149944, 0.010996  },
  { -0.949788, -0.310931, 0.034992  },
  { -0.883406, -0.464213, 0.064029  },
  { -0.783923, -0.61594,  0.077992  },
  { -0.660104, -0.746118, 0.087014  },
  { -0.521822, -0.848711, 0.085971  },
  { -0.380935, -0.922844, 0.05699   }

};


//
// quick C function
//

float gkg::SmsVb15GetUniformOrientation( int32_t orientationCount,
                                         int32_t index, 
                                         int32_t coordinate )
{

  try
  {

    switch ( orientationCount )
    {

      case 6 :

        return _orientation006[ index ][ coordinate ];

      case 10 :

        return _orientation010[ index ][ coordinate ];

      case 12 :

        return _orientation012[ index ][ coordinate ];

      case 20 :

        return _orientation020[ index ][ coordinate ];

      case 30 :

        return _orientation030[ index ][ coordinate ];

      case 64 :

        return _orientation064[ index ][ coordinate ];

      case 256 :

        return _orientation256[ index ][ coordinate ];

      default:

        throw std::runtime_error( "not a valid orientation count" );
        return 0.0;

    }

  }
  GKG_CATCH( "float gkg::SmsVb15GetUniformOrientation( "
             "int orientationCount, int index, int coordinate )" );

}



//
// class SmsVb15OrientationSet
//

gkg::SmsVb15OrientationSet::SmsVb15OrientationSet( int32_t count )
                           : gkg::OrientationSet( count )
{

  try
  {

    int32_t index;
    for ( index = 0; index < count; index++ )
    {

      _orientations[ index ].x = gkg::SmsVb15GetUniformOrientation( count,
                                                                    index,
                                                                    0 );
      _orientations[ index ].y = gkg::SmsVb15GetUniformOrientation( count,
                                                                    index,
                                                                    1 );
      _orientations[ index ].z = gkg::SmsVb15GetUniformOrientation( count,
                                                                    index,
                                                                    2 );

    }


  }
  GKG_CATCH( "gkg::SmsVb15OrientationSet::SmsVb15OrientationSet( "
             "int32_t count )" );

}


gkg::SmsVb15OrientationSet::~SmsVb15OrientationSet()
{
}

